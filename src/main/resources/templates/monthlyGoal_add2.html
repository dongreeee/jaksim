<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="/styles.css" rel="stylesheet"/>
    <title>ëª¨ë°”ì¼ ì…ë ¥ í¼</title>
    <style>
<!--        label {-->
<!--          display: block;-->
<!--          margin-top: 16px;-->
<!--          margin-bottom: 6px;-->
<!--          font-weight: bold;-->
<!--        }-->

         .label-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 16px;
      margin-bottom: 6px;
    }
    .label-row label {
      font-weight: bold;
    }

     input[type="color"] {
      width: 30px;
      height: 30px;
      border: none;
      padding: 0;
      background: none;
      cursor: pointer;
    }

        input[type="text"],
        textarea {
          width: 100%;
          padding: 12px;
          font-size: 16px;
          border: 1px solid #ccc;
          border-radius: 8px;
          box-sizing: border-box;
          margin: 12px 0;
        }
        textarea {
          resize: vertical;
          min-height: 100px;
        }
        .save-btn {
          width: 100%;
          padding: 14px;
          font-size: 16px;
          background-color: black;
          color: white;
          cursor: pointer;
        }

    </style>
</head>
<body>
<div th:replace="~{nav.html::navbar}"></div>
<div class="container" style="margin-top:30px; padding:20px;">
    <div class="calendar-widget2" id="calendar3" style="width:100%;" >
        <!-- JavaScriptë¡œ ì±„ì›Œì§ -->
    </div>
    <form id="monthlyForm" action="/monthlyGoal/addContent" method="post" th:unless="${today}">


        <input type="hidden" class="goal-date" name="date" id="date" th:value="${date}">
        <!--      disabledëŠ” ê°’ì„ ì „ë‹¬í•˜ì§€ ì•ŠìŒ   -->
        <input type="hidden" name="month" id="goal_month" th:value="${month}">
        <input type="hidden" name="goal_id" id="goal_id" >
        <div id="div_goal_add" style="display:none;">
            <input type="text" id="content" name="content" placeholder="ì˜¤ëŠ˜ì˜ ëª©í‘œë¥¼ ë‹¬ì„±í–ˆë‚˜ìš”? ">
            <button class="save-btn" type="submit" onclick="submitForm()">ë‹¬ ì„± ì™„ ë£Œ</button>
        </div>

    </form>

    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <span class="close-btn" onclick="closeModal()">Ã—</span>
            <input type="text" name="goal_title" id="goal_title" placeholder="ëª©í‘œë¥¼ ì…ë ¥í•˜ì„¸ìš”" />
            <button class="modal-btn" onclick="goalMonthly()">ì €ì¥í•˜ê¸°</button>
        </div>
    </div>

</div>



<!-- STOMP & SockJS CDN -->
<script src="https://cdn.jsdelivr.net/npm/sockjs-client@1.6.1/dist/sockjs.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/stompjs@2.3.3/lib/stomp.min.js"></script>

<!-- ê³µí†µ WebSocket ì—°ê²° ìŠ¤í¬ë¦½íŠ¸ -->
<script src="/common.js"></script>

<script>
    document.getElementById('monthlyForm').addEventListener('submit', function (event) {
      const content = document.getElementById('content').value.trim();
      const date = document.getElementById('date').value;

      if (!content) {
        alert("ë‚´ìš©ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.");
        event.preventDefault();
        return;
      }

    });

</script>

<script>
    // ì „ì—­ ë³€ìˆ˜ (ìŠ¤í¬ë¦½íŠ¸ ìƒë‹¨ì— ìœ„ì¹˜)
    let emojiMap = {};           // ì„œë²„ì—ì„œ ë°›ì€ ë‚ ì§œ->ì´ëª¨ì§€ ë§µ
    let allowedMonths = [];      // ì„œë²„ì—ì„œ ë°›ì€ ë°ì´í„° ì¡´ì¬ ì›” ëª©ë¡ (['2025-07','2025-08',...])
    let minAllowedYm = null;     // ê¸°ë¡ ì‹œì‘(ìµœì´ˆ ì›”) 'YYYY-MM'
    let maxAllowedYm = null;     // í˜„ì¬ ë‹¬ 'YYYY-MM'
    let currentYear = new Date().getFullYear();
    let currentMonth = new Date().getMonth(); // 0~11

    // ìœ í‹¸: YYYY-MM ë¬¸ìì—´ ë¹„êµ (a < b => -1, a==b => 0, a>b => 1)
    function compareYm(a, b) {
      if (!a || !b) return 0;
      const [ay, am] = a.split('-').map(Number);
      const [by, bm] = b.split('-').map(Number);
      if (ay !== by) return ay < by ? -1 : 1;
      if (am !== bm) return am < bm ? -1 : 1;
      return 0;
    }

    // í˜„ì¬ ë‹¬ YYYY-MM
    function getCurrentYmString() {
      const now = new Date();
      return `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
    }

    // ì´ˆê¸° ë¡œë“œ ì‹œ í˜¸ì¶œ
    document.addEventListener('DOMContentLoaded', function () {
      // maxAllowedYmì€ "í˜„ì¬ë‹¬"ë¡œ ê³ ì •
      maxAllowedYm = getCurrentYmString();
      fetchGoalDatesAndRender3();
    });

    // ë‹¬ë ¥ ë Œë”ë§ (ë²„íŠ¼ disabled ì²˜ë¦¬ í¬í•¨)
    function renderCalendar3() {
      const today = new Date();
      const calendar = document.getElementById('calendar3');

      const year = currentYear;
      const month = currentMonth;
      const date = today.getDate();
      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);
      const monthName = `${month + 1}`;

      // í˜„ì¬ ë³´ê³  ìˆëŠ” ym
      const currentYm = `${year}-${String(month + 1).padStart(2, '0')}`;

      // ë²„íŠ¼ í™œì„± ì—¬ë¶€ íŒë‹¨
      const leftDisabled = (minAllowedYm && compareYm(currentYm, minAllowedYm) <= 0) ? 'disabled' : '';
      const rightDisabled = (maxAllowedYm && compareYm(currentYm, maxAllowedYm) >= 0) ? 'disabled' : '';

      calendar.innerHTML = `
        <div class='slide-bar-monthly'>
          <button id="btn-prev" onclick="changeMonth(-1)" ${leftDisabled}>â†</button>
          <h3>${year}ë…„ ${monthName}ì›”</h3>
          <button id="btn-next" onclick="changeMonth(1)" ${rightDisabled}>â†’</button>
          <span id="goal_add" onclick="openModal()"> ëª©í‘œ ì§€ì •í•˜ê¸° + </span>
          <span id="goal_update" style="display:none;"></span>
        </div>
      `;

      const days = document.createElement('div');
      days.className = 'days';

      const dayNames = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'];
      dayNames.forEach(name => {
        const d = document.createElement('div');
        d.className = 'day-header';
        d.textContent = name;
        days.appendChild(d);
      });

      const startDay = firstDay.getDay() === 0 ? 6 : firstDay.getDay() - 1;
      for (let i = 0; i < startDay; i++) {
        const empty = document.createElement('div');
        days.appendChild(empty);
      }

      for (let i = 1; i <= lastDay.getDate(); i++) {
        const fullDate = `${year}-${String(month + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
        const d = document.createElement('div');
        d.className = 'day';

        if (i === date && month === today.getMonth() && year === today.getFullYear()) {
          d.classList.add('today');
        }

        if (emojiMap[fullDate]) {
          d.innerHTML = `<span class="emoji-day">${emojiMap[fullDate]}</span>`;
        } else {
          d.textContent = i;
        }

        days.appendChild(d);
      }

      calendar.appendChild(days);

      // ë Œë” í›„ í•´ë‹¹ ì›”ì˜ íƒ€ì´í‹€ ëª©í‘œ ë¶ˆëŸ¬ì˜¤ê¸°
      fetchMonthlyGoalView1(year, month + 1); // monthëŠ” 0~11ì´ë¯€ë¡œ +1
    }

    // ì›” ë³€ê²½ í•¨ìˆ˜: ë²”ìœ„ ë²—ì–´ë‚˜ë©´ alert
    function changeMonth(offset) {
      let nextMonth = currentMonth + offset;
      let nextYear = currentYear;

      if (nextMonth < 0) {
        nextMonth = 11;
        nextYear -= 1;
      } else if (nextMonth > 11) {
        nextMonth = 0;
        nextYear += 1;
      }

      const nextYm = `${nextYear}-${String(nextMonth + 1).padStart(2, '0')}`;

      // ë²”ìœ„ ê²€ì‚¬: minAllowedYm <= nextYm <= maxAllowedYm
      if (minAllowedYm && compareYm(nextYm, minAllowedYm) < 0) {
        alert('ê¸°ë¡ì´ ì‹œì‘ëœ ìµœì´ˆ ë‹¬ ì´ì „ìœ¼ë¡œëŠ” ì´ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      if (maxAllowedYm && compareYm(nextYm, maxAllowedYm) > 0) {
        alert('í˜„ì¬ ë‹¬ ì´í›„ë¡œëŠ” ì´ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }

      // í—ˆìš© ë²”ìœ„ ë‚´ì´ë©´ ë³€ê²½
      currentMonth = nextMonth;
      currentYear = nextYear;
      renderCalendar3();
    }

    // ì„œë²„ì—ì„œ ëª©í‘œ ë‚ ì§œ ë° allowedMonths ê°€ì ¸ì˜¤ê¸°
    function fetchGoalDatesAndRender3() {
      fetch('/monthlyGoal/goalCount')
        .then(res => res.json())
        .then(data => {
          const goalDates = data.goalDates || [];       // ['2025-07-01', '2025-07-12', ...]
          const allowed = data.allowedMonths || [];     // ['2025-07', '2025-08']

          // ë‚ ì§œ->ì´ëª¨ì§€ ë§µ ìƒì„±
          emojiMap = goalDates.reduce((acc, date) => {
            acc[date] = 'ğŸŒŸ';
            return acc;
          }, {});

          // allowedMonths ì„¤ì •
          allowedMonths = allowed;

          // minAllowedYm ê³„ì‚°: allowedMonths ì¤‘ ê°€ì¥ ì´ë¥¸ ê°’
          if (allowedMonths.length > 0) {
            // YYYY-MMì´ë¯€ë¡œ ë¬¸ìì—´ ì •ë ¬ë¡œë„ ê°€ëŠ¥
            const sorted = allowedMonths.slice().sort();
            minAllowedYm = sorted[0];
          } else {
            // ê¸°ë¡ì´ ì—†ìœ¼ë©´ minì„ í˜„ì¬ ë‹¬ë¡œ ì„¤ì •(ì´ì „ìœ¼ë¡œ ëª»ê°€ê²Œ)
            minAllowedYm = getCurrentYmString();
          }

          // maxAllowedYmëŠ” ì´ë¯¸ current(ì˜¤ëŠ˜ ê¸°ì¤€)ìœ¼ë¡œ ì„¸íŒ…ë˜ì–´ ìˆìŒ

          // í˜„ì¬ ë³´ê³ ìˆëŠ” ë‹¬ì´ maxë³´ë‹¤ í¬ë©´(ì˜ˆ: ë¸Œë¼ìš°ì €ê°€ ë‹¤ë¥¸ ì‹œê°„ëŒ€ ë“±) clamp
          const currentYm = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}`;
          if (compareYm(currentYm, maxAllowedYm) > 0) {
            // í˜„ì¬ ë³´ê³ ìˆëŠ” ë‹¬ì„ maxë¡œ ë§ì¶¤
            const [my, mm] = maxAllowedYm.split('-').map(Number);
            currentYear = my;
            currentMonth = mm - 1;
          }

          renderCalendar3();
        })
        .catch(err => {
          console.log('fetchGoalDatesAndRender3 error:', err.message);
          // ì—ëŸ¬ì‹œ ê¸°ë³¸ê°’: ì•„ë¬´ ë°ì´í„° ì—†ìŒ -> ì´ë™ ë¶ˆê°€(ìµœì´ˆë‹¬ == í˜„ì¬ë‹¬)
          emojiMap = {};
          allowedMonths = [];
          minAllowedYm = getCurrentYmString();
          maxAllowedYm = getCurrentYmString();
          renderCalendar3();
        });
    }

    // íŠ¹ì • ì›”ì˜ ëª©í‘œ íƒ€ì´í‹€ ê°€ì ¸ì˜¤ê¸° (ì˜ˆì‹œ)
    function fetchMonthlyGoalView(year, month) {
      const ym = `${year}-${String(month).padStart(2, '0')}`;
      const el3 = document.getElementById('goal_id');
      fetch(`/monthlyGoal/view?ym=${ym}`)
        .then(res => {
          if (!res.ok) throw new Error('no goal');
          return res.json();
        })
        .then(data => {
          if (data && data.title) {
            document.getElementById('goal_update').style.display = 'inline';
            document.getElementById('goal_update').textContent = data.title;
          } else {
            document.getElementById('goal_update').style.display = 'none';
          }
        })
        .catch(err => {
          // íƒ€ì´í‹€ì´ ì—†ê±°ë‚˜ ì—ëŸ¬ë©´ ìˆ¨ê¹€
          document.getElementById('goal_update').style.display = 'none';
        });
    }

    // ëª¨ë‹¬ ì˜¤í”ˆ/í´ë¡œì¦ˆ (ê¸°ì¡´ í•¨ìˆ˜ ìœ ì§€)
    function openModal() {
      document.getElementById('modalOverlay').style.display = 'flex';
    }
    function closeModal() {
      document.getElementById('goal_title').value = '';
      document.getElementById('modalOverlay').style.display = 'none';
    }
</script>

<script>
    (function() {
      // --- ë¡œì»¬(ì´ IIFE ë‚´ë¶€) ë³€ìˆ˜: ì „ì—­ ì¶©ëŒ ì—†ìŒ ---
      let emojiMap = {};           // ì„œë²„ì—ì„œ ë°›ì€ ë‚ ì§œ->ì´ëª¨ì§€ ë§µ
      let allowedMonths = [];      // ì„œë²„ì—ì„œ ë°›ì€ ë°ì´í„° ì¡´ì¬ ì›” ëª©ë¡ (['2025-07','2025-08',...])
      let minAllowedYm = null;     // ê¸°ë¡ ì‹œì‘(ìµœì´ˆ ì›”) 'YYYY-MM'
      let maxAllowedYm = null;     // í˜„ì¬ ë‹¬ 'YYYY-MM'
      let currentYear = new Date().getFullYear();
      let currentMonth = new Date().getMonth(); // 0~11

      // ìœ í‹¸: YYYY-MM ë¬¸ìì—´ ë¹„êµ (a < b => -1, a==b => 0, a>b => 1)
      function compareYm(a, b) {
        if (!a || !b) return 0;
        const [ay, am] = a.split('-').map(Number);
        const [by, bm] = b.split('-').map(Number);
        if (ay !== by) return ay < by ? -1 : 1;
        if (am !== bm) return am < bm ? -1 : 1;
        return 0;
      }

      // í˜„ì¬ ë‹¬ YYYY-MM
      function getCurrentYmString() {
        const now = new Date();
        return `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
      }

      // ì´ˆê¸° ë¡œë“œ ì‹œ í˜¸ì¶œ
      document.addEventListener('DOMContentLoaded', function () {
        maxAllowedYm = getCurrentYmString();
        fetchGoalDatesAndRender3();
      });

      // ë‹¬ë ¥ ë Œë”ë§ (ë²„íŠ¼ disabled ì²˜ë¦¬ í¬í•¨)
      function renderCalendar3() {
        const today = new Date();
        const calendar = document.getElementById('calendar3');

        const year = currentYear;
        const month = currentMonth;
        const date = today.getDate();
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const monthName = `${month + 1}`;

        // í˜„ì¬ ë³´ê³  ìˆëŠ” ym
        const currentYm = `${year}-${String(month + 1).padStart(2, '0')}`;

        // ë²„íŠ¼ í™œì„± ì—¬ë¶€ íŒë‹¨
        const leftDisabled = (minAllowedYm && compareYm(currentYm, minAllowedYm) <= 0) ? 'disabled' : '';
        const rightDisabled = (maxAllowedYm && compareYm(currentYm, maxAllowedYm) >= 0) ? 'disabled' : '';

        calendar.innerHTML = `
          <div class='slide-bar-monthly'>
            <button id="btn-prev" onclick="changeMonth(-1)" ${leftDisabled}>â†</button>
            <h3>${year}ë…„ ${monthName}ì›”</h3>
            <button id="btn-next" onclick="changeMonth(1)" ${rightDisabled}>â†’</button>
            <span id="goal_add" onclick="openModal()"> ëª©í‘œ ì§€ì •í•˜ê¸° + </span>
            <span id="goal_update" style="display:none;"></span>
          </div>
        `;

        const days = document.createElement('div');
        days.className = 'days';

        const dayNames = ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'];
        dayNames.forEach(name => {
          const d = document.createElement('div');
          d.className = 'day-header';
          d.textContent = name;
          days.appendChild(d);
        });

        const startDay = firstDay.getDay() === 0 ? 6 : firstDay.getDay() - 1;
        for (let i = 0; i < startDay; i++) {
          const empty = document.createElement('div');
          days.appendChild(empty);
        }

        for (let i = 1; i <= lastDay.getDate(); i++) {
          const fullDate = `${year}-${String(month + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
          const d = document.createElement('div');
          d.className = 'day';

          if (i === date && month === today.getMonth() && year === today.getFullYear()) {
            d.classList.add('today');
          }

          if (emojiMap[fullDate]) {
            d.innerHTML = `<span class="emoji-day">${emojiMap[fullDate]}</span>`;
          } else {
            d.textContent = i;
          }

          days.appendChild(d);
        }

        calendar.appendChild(days);

        // ë Œë” í›„ í•´ë‹¹ ì›”ì˜ íƒ€ì´í‹€ ëª©í‘œ ë¶ˆëŸ¬ì˜¤ê¸°
        fetchMonthlyGoalView(year, month + 1); // monthëŠ” 0~11ì´ë¯€ë¡œ +1
      }

      // ì›” ë³€ê²½ í•¨ìˆ˜: ë²”ìœ„ ë²—ì–´ë‚˜ë©´ alert
      // â†’ ì´ í•¨ìˆ˜ëŠ” HTMLì˜ onclickì—ì„œ ì „ì—­ìœ¼ë¡œ í˜¸ì¶œë˜ë¯€ë¡œ windowì— ë…¸ì¶œ
      window.changeMonth = function(offset) {
        let nextMonth = currentMonth + offset;
        let nextYear = currentYear;

        if (nextMonth < 0) {
          nextMonth = 11;
          nextYear -= 1;
        } else if (nextMonth > 11) {
          nextMonth = 0;
          nextYear += 1;
        }

        const nextYm = `${nextYear}-${String(nextMonth + 1).padStart(2, '0')}`;

        // ë²”ìœ„ ê²€ì‚¬: minAllowedYm <= nextYm <= maxAllowedYm
        if (minAllowedYm && compareYm(nextYm, minAllowedYm) < 0) {
          alert('ê¸°ë¡ì´ ì‹œì‘ëœ ìµœì´ˆ ë‹¬ ì´ì „ìœ¼ë¡œëŠ” ì´ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
          return;
        }
        if (maxAllowedYm && compareYm(nextYm, maxAllowedYm) > 0) {
          alert('í˜„ì¬ ë‹¬ ì´í›„ë¡œëŠ” ì´ë™í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
          return;
        }

        // í—ˆìš© ë²”ìœ„ ë‚´ì´ë©´ ë³€ê²½
        currentMonth = nextMonth;
        currentYear = nextYear;
        renderCalendar3();
      };

      // ì„œë²„ì—ì„œ ëª©í‘œ ë‚ ì§œ ë° allowedMonths ê°€ì ¸ì˜¤ê¸°
      function fetchGoalDatesAndRender3() {
        fetch('/monthlyGoal/goalCount')
          .then(res => res.json())
          .then(data => {
            const goalDates = data.goalDates || [];       // ['2025-07-01', '2025-07-12', ...]
            const allowed = data.allowedMonths || [];     // ['2025-07', '2025-08']

            // ë‚ ì§œ->ì´ëª¨ì§€ ë§µ ìƒì„±
            emojiMap = goalDates.reduce((acc, date) => {
              acc[date] = 'ğŸŒŸ';
              return acc;
            }, {});

            // allowedMonths ì„¤ì •
            allowedMonths = allowed;

            // minAllowedYm ê³„ì‚°: allowedMonths ì¤‘ ê°€ì¥ ì´ë¥¸ ê°’
            if (allowedMonths.length > 0) {
              const sorted = allowedMonths.slice().sort();
              minAllowedYm = sorted[0];
            } else {
              // ê¸°ë¡ì´ ì—†ìœ¼ë©´ minì„ í˜„ì¬ ë‹¬ë¡œ ì„¤ì •(ì´ì „ìœ¼ë¡œ ëª»ê°€ê²Œ)
              minAllowedYm = getCurrentYmString();
            }

            // maxAllowedYmëŠ” ì´ë¯¸ current(ì˜¤ëŠ˜ ê¸°ì¤€)ìœ¼ë¡œ ì„¸íŒ…ë˜ì–´ ìˆìŒ

            // í˜„ì¬ ë³´ê³ ìˆëŠ” ë‹¬ì´ maxë³´ë‹¤ í¬ë©´(ì˜ˆ: ë¸Œë¼ìš°ì €ê°€ ë‹¤ë¥¸ ì‹œê°„ëŒ€ ë“±) clamp
            const currentYm = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}`;
            if (compareYm(currentYm, maxAllowedYm) > 0) {
              const [my, mm] = maxAllowedYm.split('-').map(Number);
              currentYear = my;
              currentMonth = mm - 1;
            }

            renderCalendar3();
          })
          .catch(err => {
            console.log('fetchGoalDatesAndRender3 error:', err.message);
            // ì—ëŸ¬ì‹œ ê¸°ë³¸ê°’: ì•„ë¬´ ë°ì´í„° ì—†ìŒ -> ì´ë™ ë¶ˆê°€(ìµœì´ˆë‹¬ == í˜„ì¬ë‹¬)
            emojiMap = {};
            allowedMonths = [];
            minAllowedYm = getCurrentYmString();
            maxAllowedYm = getCurrentYmString();
            renderCalendar3();
          });
      }

      // íŠ¹ì • ì›”ì˜ ëª©í‘œ íƒ€ì´í‹€ ê°€ì ¸ì˜¤ê¸°
      function fetchMonthlyGoalView(year, month) {
        const ym = `${year}-${String(month).padStart(2, '0')}`;

        fetch(`/monthlyGoal/info/${ym}`)
          .then(res => {
            if (!res.ok) throw new Error('no goal');
            return res.json();
          })
          .then(data => {
            if (data && data.title) {
              document.getElementById('goal_update').style.display = 'inline';
              document.getElementById('goal_update').textContent = data.title;
              document.getElementById('goal_add').style.display = 'none';
            } else {
              document.getElementById('goal_update').style.display = 'none';
            }
          })
          .catch(err => {
            // íƒ€ì´í‹€ì´ ì—†ê±°ë‚˜ ì—ëŸ¬ë©´ ìˆ¨ê¹€
            document.getElementById('goal_update').style.display = 'none';
          });
      }

      // ëª¨ë‹¬ ì˜¤í”ˆ/í´ë¡œì¦ˆ (onclickì—ì„œ í˜¸ì¶œí•˜ë¯€ë¡œ ì „ì—­ì— ë…¸ì¶œ)
      window.openModal = function() {
        document.getElementById('modalOverlay').style.display = 'flex';
      };
      window.closeModal = function() {
        document.getElementById('goal_title').value = '';
        document.getElementById('modalOverlay').style.display = 'none';
      };

      // (ì›í•˜ë©´ ì™¸ë¶€ì—ì„œ ë‹¬ë ¥ ê°•ì œ ë Œë”ë§ í˜¸ì¶œ ê°€ëŠ¥)
      window.renderCalendar3 = renderCalendar3;

    })(); // IIFE ì¢…ë£Œ
</script>
<script>
    function goalMonthly() {

    const title = document.getElementById('goal_title').value;
    const month = document.getElementById('goal_month').value;

    fetch('/monthlyGoal/add', {
        method: 'POST',
        headers: {
              'Content-Type': 'application/json'
        },
        body: JSON.stringify({ title : title, dateym: month})
        })
        .then(response => {
         if (!response.ok) throw new Error('ì„œë²„ ì˜¤ë¥˜');
            console.log('ì—…ë°ì´íŠ¸ ì„±ê³µ');
            document.getElementById('goal_update').textContent = title;
            document.getElementById('goal_add').style.display = 'none';
            document.getElementById('goal_update').style.display = 'block';
            closeModal();
         })
         .catch(err => {
            console.error('ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:', err);
    });
  }
</script>

</body>
</html>
