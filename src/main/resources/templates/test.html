<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>이달의 목표 달력</title>
    <style>
        body {
          font-family: 'Arial', sans-serif;
          background: #f0f0f5;
          padding: 20px;
          max-width: 480px;
          margin: auto;
        }

        h2 {
          margin-bottom: 0.5rem;
        }

        .goal-container {
          background: #fff;
          padding: 1rem;
          border-radius: 12px;
          margin-bottom: 1rem;
          box-shadow: 0 0 8px rgba(0, 0, 0, 0.05);
        }

        .goal-container input {
          width: 70%;
          padding: 8px;
          font-size: 1rem;
          border: 1px solid #ccc;
          border-radius: 6px;
        }

        .goal-container button {
          padding: 8px 12px;
          font-size: 1rem;
          background-color: #888eff;
          color: white;
          border: none;
          border-radius: 6px;
          cursor: pointer;
          margin-left: 8px;
        }

        #saved-goal {
          margin-top: 0.5rem;
          font-weight: bold;
          color: #444;
        }

        .icon-picker {
          background: #fff;
          padding: 0.8rem;
          border-radius: 12px;
          margin-bottom: 1rem;
          box-shadow: 0 0 8px rgba(0, 0, 0, 0.05);
          text-align: center;
        }

        .icon-picker span {
          font-size: 28px;
          margin: 0 8px;
          cursor: pointer;
          transition: transform 0.2s;
        }

        .icon-picker span.selected {
          transform: scale(1.3);
          border-bottom: 2px solid #888eff;
        }

        .calendar {
          background: #fff;
          padding: 1rem;
          border-radius: 12px;
          box-shadow: 0 0 8px rgba(0, 0, 0, 0.05);
        }

        table {
          width: 100%;
          border-collapse: collapse;
          text-align: center;
        }

        th {
          color: #888eff;
          padding: 8px 0;
        }

        td {
          width: 14.2%;
          height: 50px;
          cursor: default;
          font-size: 20px;
          user-select: none;
        }

        td.today {
          color: #000;
          font-weight: bold;
          background-color: #fffbe6;
          border-radius: 6px;
          cursor: pointer;
        }

        td.checked {
          background-color: #e6ffe6;
          pointer-events: none;
        }

        td:hover.today:not(.checked) {
          background-color: #f0f0ff;
        }
    </style>
</head>
<body>

<div class="goal-container">
    <h2>🎯 이번 달의 목표</h2>
    <input type="text" id="goal-input" placeholder="예: 매일 운동하기">
    <button onclick="saveGoal()">저장</button>
    <p id="saved-goal"></p>
</div>

<div class="icon-picker">
    <span onclick="selectIcon(this, '❤️')">❤️</span>
    <span onclick="selectIcon(this, '💪')">💪</span>
    <span onclick="selectIcon(this, '🌟')">🌟</span>
    <span onclick="selectIcon(this, '🔥')">🔥</span>
    <span onclick="selectIcon(this, '🧠')">🧠</span>
</div>

<div class="calendar">
    <h2 style="text-align: center;">📅 2025년 7월</h2>
    <table id="calendar-table">
        <thead>
        <tr>
            <th>일</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>토</th>
        </tr>
        </thead>
        <tbody id="calendar-body">
        <!-- JS로 자동 생성 -->
        </tbody>
    </table>
</div>

<script>
    let selectedIcon = '❤️';
    const checkedDates = {}; // 오늘 인증한 날짜 저장

    function saveGoal() {
      const input = document.getElementById('goal-input');
      const display = document.getElementById('saved-goal');
      display.textContent = '🌟 목표: ' + input.value;
      input.value = '';
    }

    function selectIcon(elem, icon) {
      selectedIcon = icon;
      document.querySelectorAll('.icon-picker span').forEach(span => {
        span.classList.remove('selected');
      });
      elem.classList.add('selected');
    }

    function generateCalendar(year, month) {
      const tbody = document.getElementById('calendar-body');
      tbody.innerHTML = '';

      const firstDay = new Date(year, month - 1, 1);
      const lastDate = new Date(year, month, 0).getDate();
      const startDay = firstDay.getDay();

      const today = new Date();
      const todayDate = today.getDate();
      const isThisMonth = today.getFullYear() === year && (today.getMonth() + 1) === month;

      let row = document.createElement('tr');
      for (let i = 0; i < startDay; i++) {
        row.appendChild(document.createElement('td'));
      }

      for (let date = 1; date <= lastDate; date++) {
        const cell = document.createElement('td');
        cell.textContent = date;

        // 오늘 날짜만 체크 가능
        if (isThisMonth && date === todayDate) {
          cell.classList.add('today');

          cell.addEventListener('click', function () {
            // 이미 체크했는지 확인
            if (checkedDates[date]) {
              alert("오늘은 이미 체크했어요! 내일 또 도전해보세요 😄");
              return;
            }

            const answer = prompt("오늘 어떤 노력을 했나요?");
            if (answer && answer.trim() !== "") {
              this.textContent = selectedIcon;
              this.classList.add('checked');
              checkedDates[date] = {
                icon: selectedIcon,
                memo: answer
              };
            } else {
              alert("입력 내용을 작성해야 체크할 수 있어요!");
            }
          });
        } else {
          cell.style.color = "#aaa";
          cell.style.cursor = "not-allowed";
        }

        row.appendChild(cell);
        if ((startDay + date) % 7 === 0) {
          tbody.appendChild(row);
          row = document.createElement('tr');
        }
      }
      tbody.appendChild(row);
    }

    // 초기화
    generateCalendar(2025, 7);
    document.querySelectorAll('.icon-picker span')[0].classList.add('selected');
</script>

</body>
</html>
